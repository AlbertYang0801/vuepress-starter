# åºåˆ—åŒ–é—®é¢˜

Javaå¯¹è±¡çš„åºåˆ—åŒ–ä¸»è¦æœ‰ä¸¤ä¸ªï¼š

1. ç½‘ç»œä¼ è¾“
   
    æ•°æ®åœ¨ç½‘ç»œä¸­ä¼ è¾“æ˜¯é€šè¿‡å­—èŠ‚æµå½¢å¼çš„ï¼Œåˆ°æœåŠ¡ç«¯éœ€è¦è§£ç ã€‚
    
2. å¯¹è±¡æŒä¹…åŒ–

## Javaåºåˆ—åŒ–

Javaåºåˆ—åŒ–æœºåˆ¶æ˜¯åŸºäºå¯¹è±¡çš„ç±»ç»“æ„è¿›è¡Œçš„ã€‚

å½“å¯¹è±¡éœ€è¦åºåˆ—åŒ–æ—¶ï¼Œä¼šå°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµåœ¨ç½‘ç»œä¼ è¾“ã€‚

ååºåˆ—åŒ–æ—¶ï¼Œå°±æ˜¯å°†å­—èŠ‚æµè½¬æ¢ä¸ºå¯¹è±¡çš„è¿‡ç¨‹ã€‚Javaä¼šå°†å­—èŠ‚æµè½¬æ¢ä¸ºå¯¹è±¡é‡æ–°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚

Javaçš„åºåˆ—åŒ–æœºåˆ¶æ˜¯é€šè¿‡å®ç°`java.io.Serializable`æ¥å£æ¥å®ç°çš„ã€‚è¯¥æ¥å£æ˜¯ä¸€ä¸ªæ ‡è®°æ¥å£ï¼Œæ²¡æœ‰ä»»ä½•æ–¹æ³•å®šä¹‰ã€‚åªæœ‰å®ç°äº†`Serializable`æ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ã€‚

<aside>
ğŸ’¡Javaåºåˆ—åŒ–æ•ˆç‡ä¸é«˜




### ç¼ºç‚¹

1. åºåˆ—åŒ–æ€§èƒ½è¾ƒä½
   
    ```java
    The jdk serializable cost time is  : 1343 ms
    -------------------------------------
    The byte array serializable cost time is : 128 ms
    ```
    
2. åºåˆ—åŒ–åå­—èŠ‚æ•°ç»„è¿‡å¤§
   
    ```java
    The jdk serializable length is : 128
    The byte array serializable length is : 24
    ```
    
3. ä¸æ”¯æŒè·¨è¯­è¨€ï¼Œåªæ”¯æŒJavaï¼Œå…¶å®ƒè¯­è¨€æ— æ³•ååºåˆ—åŒ–ã€‚

## Protocol Buffers

```java
 b.group(bossGroup, workerGroup)
                    .channel(NioServerSocketChannel.class)
                    .option(ChannelOption.SO_BACKLOG, 100)
                    .childHandler(new ChannelInitializer<SocketChannel>() {
                        @Override
                        public void initChannel(SocketChannel ch) {
                            /*å»é™¤æ¶ˆæ¯é•¿åº¦éƒ¨åˆ†ï¼ŒåŒæ—¶æ ¹æ®è¿™ä¸ªæ¶ˆæ¯é•¿åº¦è¯»å–å®é™…çš„æ•°æ®*/
                            ch.pipeline().addLast(new ProtobufVarint32FrameDecoder());
                            //Protobufè¿›è¡Œè§£ç ï¼Œååºåˆ—åŒ–
                            ch.pipeline().addLast(new ProtobufDecoder(PersonProto.Person.getDefaultInstance()));
                            ch.pipeline().addLast(new ProtoBufServerHandler());
                        }
                    });
```

```java
            b.group(group)
                    .channel(NioSocketChannel.class)
                    .option(ChannelOption.TCP_NODELAY, true)
                    .handler(new ChannelInitializer<SocketChannel>() {
                        @Override
                        public void initChannel(SocketChannel ch)
                                throws Exception {
                            /*åŠ ä¸€ä¸ªæ¶ˆæ¯é•¿åº¦ï¼Œç”±nettyè‡ªåŠ¨è®¡ç®—*/
                            ch.pipeline().addLast(new ProtobufVarint32LengthFieldPrepender());
                            //Protobufè¿›è¡Œç¼–ç ï¼Œè´Ÿè´£åºåˆ—åŒ–
                            ch.pipeline().addLast(new ProtobufEncoder());
                            ch.pipeline().addLast(new ProtoBufClientHandler());
                        }
                    });
```